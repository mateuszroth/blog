<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Software Sensei&#39;s Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Software Sensei&#39;s Notes">
<meta property="og:url" content="https://mateuszroth.github.io/blog/index.html">
<meta property="og:site_name" content="Software Sensei&#39;s Notes">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Mateusz Roth">
<meta property="article:tag" content="konsultant, specjalista, programista, developer, consultant, specialist, Software Engineer, iOS, App, Mac, Android, Chrome, Safari, Firefox, Front End, Web, Development, JavaScript, ECMAScript, ES6, ES5, React, Node.js, Express, React Native, Vue, Angular, AngularJS, Ionic, Cordova, Bootstrap, SASS, LESS, Haml, Jade, Design, UI, UX, web apps, web applications, aplikacje internetowe, tworzenie aplikacji internetowych, tworzenie stron internetowych, tworzenie aplikacji mobilnych, tworzenie wizytówek internetowych">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/blog/css/style.css">

<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">
          <div><img src="https://mateuszroth.pl/img/mateusz@2x1.png" width="100" style="position: relative; top: -20px;" /></div>
          Software Sensei&#39;s Notes
        </a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/about-me">About me</a>
        
          <a class="main-nav-link" href="/blog/categories/JavaScript/">JavaScript</a>
        
          <a class="main-nav-link" href="/blog/categories/Node-js/">Node.js</a>
        
          <a class="main-nav-link" href="/blog/categories/React/">React</a>
        
          <a class="main-nav-link" href="/blog/categories/Backend/">Backend</a>
        
          <a class="main-nav-link" href="/blog/categories/Software-Engineering/">Software Engineering</a>
        
          <a class="main-nav-link" href="/blog/archives">Other archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://mateuszroth.github.io/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><div style="
  text-align: center;
  padding: 30px;
  font-size: 18px;
  line-height: 1.5em;
  color: rgb(85, 85, 85);
">
  Hello, I'm Mateusz Roth. Welcome to my blog. I'm open-minded Software Engineer that loves learning. Specialized in web apps and JavaScript, experienced in mobile dev, interested in Node.js, frontend and UX but also feels good with other programming languages like Swift, Kotlin, ObjC, Android, C#; eager to learn and work with Python, Golang, Node.js microservices or IoT.
</div>

  
    <article id="post-Backend/Message-brokers" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/07/04/Backend/Message-brokers/" class="article-date">
  <time datetime="2021-07-04T22:00:00.000Z" itemprop="datePublished">2021-07-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Backend/">Backend</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/07/04/Backend/Message-brokers/">Message brokers</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Message-brokers"><a href="#Message-brokers" class="headerlink" title="Message brokers"></a>Message brokers</h1><ul>
<li>a message broker accepts and forwards messages</li>
<li>allows applications to communicate via a queuing mechanism</li>
<li>a program that sends messages is a <em>producer</em></li>
<li>a <em>queue</em> is essentially a large message buffer</li>
<li>many <em>producers</em> can send messages that go to one <em>queue</em>, and many <em>consumers</em> can try to receive data from one <em>queue</em></li>
<li>a <em>consumer</em> is a program that mostly waits to receive messages</li>
</ul>
<h2 id="Use-cases"><a href="#Use-cases" class="headerlink" title="Use cases"></a>Use cases</h2><ul>
<li>Point-to-point messaging</li>
<li>Publish/subscribe - event-driven architecture-based system, where applications have fewer dependencies between each other</li>
<li>Long-running tasks and crucial API like preparing files to download</li>
<li>Microservices - to create event-based communication and use the message broker together with publish/subscribe pattern instead of REST APIs</li>
<li>Transactional systems - where we have several actions that need to be made after each previous one completes</li>
</ul>
<h2 id="Advantages"><a href="#Advantages" class="headerlink" title="Advantages"></a>Advantages</h2><ul>
<li>Improved system performance by introducing asynchronous processing</li>
<li>Increased reliability by guaranteeing the transmission of messages<ul>
<li>In case of consumer failure, it can redeliver the message immediately or after some specified time</li>
</ul>
</li>
</ul>
<h2 id="Disadvantages"><a href="#Disadvantages" class="headerlink" title="Disadvantages"></a>Disadvantages</h2><ul>
<li>Increased system complexity<ul>
<li>maintaining the network between components or security issues</li>
<li>problem related to eventual consistency where some components could not have up-to-date data until the messages are propagated and processed</li>
</ul>
</li>
<li>Debugging can be harder</li>
<li>There’s a steep learning curve at first<ul>
<li>size of queues and messages, the behavior of queues, delivery settings or messages TTL</li>
</ul>
</li>
</ul>
<h2 id="Amazon-SQS-amp-SNS"><a href="#Amazon-SQS-amp-SNS" class="headerlink" title="Amazon SQS &amp; SNS"></a>Amazon SQS &amp; SNS</h2><ul>
<li>you can combine Amazon SNS power of publishing to multiple recipients with Amazon SQS durable queues</li>
</ul>
<h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><ul>
<li>(tutorial for Node.js using amqp and RabbitMQ)[<a target="_blank" rel="noopener" href="https://www.rabbitmq.com/tutorials/tutorial-one-javascript.html]">https://www.rabbitmq.com/tutorials/tutorial-one-javascript.html]</a></li>
<li>(tutorial for Node.js using amqplib and RabbitMQ)(<a target="_blank" rel="noopener" href="https://medium.com/swlh/communicating-using-rabbitmq-in-node-js-e63a4dffc8bb">https://medium.com/swlh/communicating-using-rabbitmq-in-node-js-e63a4dffc8bb</a>)</li>
</ul>
<h2 id="Sources"><a href="#Sources" class="headerlink" title="Sources"></a>Sources</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.rabbitmq.com/tutorials/tutorial-one-javascript.html">https://www.rabbitmq.com/tutorials/tutorial-one-javascript.html</a></li>
<li><a target="_blank" rel="noopener" href="https://tsh.io/blog/message-broker/">https://tsh.io/blog/message-broker/</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.logrocket.com/understanding-message-queuing-systems-using-rabbitmq/">https://blog.logrocket.com/understanding-message-queuing-systems-using-rabbitmq/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/07/04/Backend/Message-brokers/" data-id="ckqqux39h00070tvf5bu12gea" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/RabbitMQ/" rel="tag">RabbitMQ</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Backend/Microservices" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/07/04/Backend/Microservices/" class="article-date">
  <time datetime="2021-07-04T22:00:00.000Z" itemprop="datePublished">2021-07-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Backend/">Backend</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/07/04/Backend/Microservices/">Microservices</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Microservices"><a href="#Microservices" class="headerlink" title="Microservices"></a>Microservices</h1><ul>
<li>a software design architecture that breaks apart monolithic systems</li>
<li>applications are built as collections of loosely coupled services</li>
<li>data moves between microservices using “dumb pipes” such as an event broker and/or a lightweight protocol like REST</li>
</ul>
<h2 id="Advantages"><a href="#Advantages" class="headerlink" title="Advantages"></a>Advantages</h2><ul>
<li>teams can develop, maintain, and deploy each microservice independently</li>
<li>scalability, you can scale them separately; the cost of scaling is comparatively less than the monolithic architecture</li>
<li>faster development cycles (easier deployment and debugging)</li>
<li>speed up your CI/CD pipeline (against big monolithic apps)</li>
<li>it’s easier to maintain and debug a lightweight microservice than a complex application</li>
<li>isolated services have a better failure tolerance</li>
</ul>
<h2 id="Disadvantages"><a href="#Disadvantages" class="headerlink" title="Disadvantages"></a>Disadvantages</h2><ul>
<li>communication between microservices can mean poorer performance, as sending messages back and forth comes with a certain overhead</li>
<li>microservice has all the associated complexities of the distributed system</li>
<li>complex testing over a distributed environment; while unit testing may be easier with microservices, integration testing is not</li>
<li>up-front costs may be higher with microservices</li>
</ul>
<h2 id="Sources"><a href="#Sources" class="headerlink" title="Sources"></a>Sources</h2><ul>
<li><a target="_blank" rel="noopener" href="https://raygun.com/blog/what-are-microservices/">https://raygun.com/blog/what-are-microservices/</a></li>
<li><a target="_blank" rel="noopener" href="https://solace.com/blog/microservices-advantages-and-disadvantages/">https://solace.com/blog/microservices-advantages-and-disadvantages/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/07/04/Backend/Microservices/" data-id="ckqqux39i00080tvf8qvt65ss" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Microservices/" rel="tag">Microservices</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Backend/Redis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/07/03/Backend/Redis/" class="article-date">
  <time datetime="2021-07-03T22:00:00.000Z" itemprop="datePublished">2021-07-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Backend/">Backend</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/07/03/Backend/Redis/">Redis</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><ul>
<li>Redis is an in-memory data structure store that can be used as a database, cache, or publish/subscribe client.</li>
<li>In terms of WebSockets there are some ways of “sharing” the pool of open connections between many instances. One way is to use Redis’ publish/subscribe mechanism to forward emitted events between all instances of the application to make sure each open connection receives them.</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/07/03/Backend/Redis/" data-id="ckqqux39l000c0tvfctum9nkk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Redis/" rel="tag">Redis</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Backend/Authentication-and-Authorization" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/07/03/Backend/Authentication-and-Authorization/" class="article-date">
  <time datetime="2021-07-03T22:00:00.000Z" itemprop="datePublished">2021-07-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Backend/">Backend</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/07/03/Backend/Authentication-and-Authorization/">Authentication and Authorization</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Authentication-and-Authorization"><a href="#Authentication-and-Authorization" class="headerlink" title="Authentication and Authorization"></a>Authentication and Authorization</h1><ul>
<li><strong>Authentication</strong> (pl. <em>uwierzytelnianie, autentykacja</em>) describes the process of claiming an identity. That’s what you do when you log in to a service with a username and password, you authenticate yourself.</li>
<li><strong>Authorization</strong> on the other hand describes permission rules that specify the access rights of individual users and user groups to certain parts of the system, i.e. ACL.</li>
<li>In modern era, everyone is going for token based authentication instead of session based cookies.</li>
<li>A spreadsheet describing authentication techniques: (Authentication Techniques for APIs)[<a target="_blank" rel="noopener" href="https://docs.google.com/spreadsheets/d/1tAX5ZJzluilhoYKjra-uHbMCZraaQkqIHl3RIQ8mVkM/edit#gid=0]">https://docs.google.com/spreadsheets/d/1tAX5ZJzluilhoYKjra-uHbMCZraaQkqIHl3RIQ8mVkM/edit#gid=0]</a></li>
</ul>
<h2 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h2><ul>
<li>When we do token-based authentication, such as OpenID, OAuth, or OpenID Connect, we receive an <code>access_token</code> (and sometimes <code>id_token</code>) from a trusted authority</li>
<li>Passport is an authentication middleware for Node.js<ul>
<li>Packages<ul>
<li><code>bcrypt</code> for hashing user passwords</li>
<li><code>jsonwebtoken</code> for signing tokens</li>
<li><code>passport-local</code> for implementing local strategy</li>
<li><code>passport-jwt</code> for retrieving and verifying JWTs</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="OAuth2"><a href="#OAuth2" class="headerlink" title="OAuth2"></a>OAuth2</h3><ul>
<li>i.e. Facebook, Google</li>
<li>You need to register your app on authorization server such as Google. You will get <code>client id</code> for your app, you will have defined both <code>redirect URL</code> and <code>client secret</code>.</li>
<li>The <code>redirect URL</code> is used by the authorization server after an user logs in successfully to the server.</li>
<li>Sample steps:<ol>
<li>To get authorization code user calls authorization server <a target="_blank" rel="noopener" href="https://cloud.digitalocean.com/v1/oauth/authorize?response_type=code&amp;client_id=CLIENT_ID&amp;redirect_uri=CALLBACK_URL&amp;scope=read">https://cloud.digitalocean.com/v1/oauth/authorize?response_type=code&amp;client_id=CLIENT_ID&amp;redirect_uri=CALLBACK_URL&amp;scope=read</a></li>
<li>Send authorization code to our app <a target="_blank" rel="noopener" href="https://dropletbook.com/callback?code=AUTHORIZATION_CODE">https://dropletbook.com/callback?code=AUTHORIZATION_CODE</a></li>
<li>After receiveing authorization code, our app calls authorization server to get access token <a target="_blank" rel="noopener" href="https://cloud.digitalocean.com/v1/oauth/token?client_id=CLIENT_ID&amp;client_secret=CLIENT_SECRET&amp;grant_type=authorization_code&amp;code=AUTHORIZATION_CODE&amp;redirect_uri=CALLBACK_URL">https://cloud.digitalocean.com/v1/oauth/token?client_id=CLIENT_ID&amp;client_secret=CLIENT_SECRET&amp;grant_type=authorization_code&amp;code=AUTHORIZATION_CODE&amp;redirect_uri=CALLBACK_URL</a></li>
<li>Our app gets access token <code>&#123;&quot;access_token&quot;:&quot;ACCESS_TOKEN&quot;,&quot;token_type&quot;:&quot;bearer&quot;,&quot;expires_in&quot;:2592000,&quot;refresh_token&quot;:&quot;REFRESH_TOKEN&quot;,&quot;scope&quot;:&quot;read&quot;,&quot;uid&quot;:100101,&quot;info&quot;:&#123;&quot;name&quot;:&quot;Mark E. Mark&quot;,&quot;email&quot;:&quot;mark@thefunkybunch.com&quot;&#125;&#125;</code></li>
</ol>
</li>
<li>visual explanation: <a target="_blank" rel="noopener" href="https://darutk.medium.com/the-simplest-guide-to-oauth-2-0-8c71bd9a15bb">https://darutk.medium.com/the-simplest-guide-to-oauth-2-0-8c71bd9a15bb</a></li>
<li>another explanation for steps:<ol>
<li>User wants to request a resource that requires auth</li>
<li>Authorization server returns an <em>authorization code</em> to the client</li>
<li>Client then uses that <em>authorization code</em> in order to request an <em>authorization token</em> - e.g. a JWT</li>
</ol>
</li>
</ul>
<h3 id="Scalability-of-token-cookie-based-authentication"><a href="#Scalability-of-token-cookie-based-authentication" class="headerlink" title="Scalability of token/cookie based authentication"></a>Scalability of token/cookie based authentication</h3><ul>
<li>in horizontal scaling scenario you have to start replicating servers<ul>
<li>for <strong>cookie based authentication has a disadvantage of need for central session storage system</strong> that all of your application servers have access to<ul>
<li>Setting up and maintaining this type of distributed system involves in-depth technical knowledge and subsequently <strong>incurs higher financial costs</strong></li>
</ul>
</li>
<li>for <strong>JWT based authentication our application can scale easily</strong> because we can use tokens to access resources from different servers without worrying if the user was actually logged in on a particular server. You also save costs because you don’t need a dedicated server to store your sessions. Why? Because there are no sessions!</li>
</ul>
</li>
</ul>
<h2 id="Authorization"><a href="#Authorization" class="headerlink" title="Authorization"></a>Authorization</h2><h3 id="JWT-JSON-Web-Tokens"><a href="#JWT-JSON-Web-Tokens" class="headerlink" title="JWT (JSON Web Tokens)"></a>JWT (JSON Web Tokens)</h3><ul>
<li>JSON Web Token (JWT) is an open standard that defines a compact and self-contained way for securely transmitting information between parties as a JSON object.</li>
<li>JWTs can be signed using a secret (with HMAC algorithm) or a public/private key pair using RSA.</li>
<li>JWTs consist of three parts separated by dots (.), which are:<ul>
<li>Header<ul>
<li>consists of two parts: the type of the token, which is JWT, and the hashing algorithm such as HMAC SHA256 or RSA</li>
<li>JSON is encoded to Base64Url<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS256&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;JWT&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Payload<ul>
<li>The payload contains all the required information about the user</li>
<li>do not store passwords here or secret data<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;sub&quot;: &quot;1234567890&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;John Doe&quot;,</span><br><span class="line">  &quot;admin&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Signature<ul>
<li>you have to take the encoded header, the encoded payload, a secret, the algorithm specified in the header, and sign that to create signature<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + &quot;.&quot; +</span><br><span class="line">  base64UrlEncode(payload),</span><br><span class="line">  secret)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li>can be sent through an URL, POST parameter, or inside an HTTP header</li>
<li>JWT sent over as an <code>Authorization: Bearer &lt;token&gt;</code> header is a stateless authentication mechanism as the user state is never saved in the server memory</li>
</ul>
<h4 id="Advantages"><a href="#Advantages" class="headerlink" title="Advantages"></a>Advantages</h4><ul>
<li>They are easy to scale horizontally</li>
<li>due to its size its transmission is fast</li>
<li>They are easier to maintain and debug</li>
<li>They have the ability to create truly RESTful Services</li>
<li>They have built-in expiration functionality</li>
<li>JSON Web Tokens are self-contained</li>
<li>JWT is a <strong>stateless authentication</strong> mechanism as the user state is never saved in the server memory</li>
<li>doesn’t matter which domains are serving your APIs, as <strong>Cross-Origin Resource Sharing (CORS) won’t be an issue</strong> as it doesn’t use cookies</li>
<li>a good way of securely transmitting information between parties</li>
</ul>
<h4 id="Disadvantages"><a href="#Disadvantages" class="headerlink" title="Disadvantages"></a>Disadvantages</h4><ul>
<li>(Why JWTs Suck as Session Tokens)[<a target="_blank" rel="noopener" href="https://developer.okta.com/blog/2017/08/17/why-jwts-suck-as-session-tokens]">https://developer.okta.com/blog/2017/08/17/why-jwts-suck-as-session-tokens]</a></li>
</ul>
<h4 id="Precautions"><a href="#Precautions" class="headerlink" title="Precautions"></a>Precautions</h4><ul>
<li>a great care must be taken to prevent security issues and you <strong>should not keep tokens longer than required</strong></li>
<li><strong>you also should not store sensitive session data in browser storage due to lack of security</strong></li>
</ul>
<h4 id="Invalidation"><a href="#Invalidation" class="headerlink" title="Invalidation"></a>Invalidation</h4><ul>
<li>Simply remove the token from the client</li>
<li>Create a token blocklist or whitelist</li>
<li>Just keep token expiry times short and rotate them often</li>
</ul>
<h4 id="While-using-cookies"><a href="#While-using-cookies" class="headerlink" title="While using cookies"></a>While using cookies</h4><ul>
<li>Cookies/session id is not self contained. It is a reference token. During each validation the Gmail server needs to fetch the information corresponding to it.<ul>
<li>Cookie/session based authentication doesn’t scale well</li>
</ul>
</li>
<li>JWT is self contained. It is a value token. So during each validation the Gmail server does not needs to fetch the information corresponding to it. It is most suitable for Microservices Architecture<ul>
<li>with JWTs REST API is stateless and therefore without side effects means that maintainability and debugging are made much easier</li>
<li>CORS - for an API to be served from one server and for the actual application to consume it from another. To make this happen, we need to enable Cross-Origin Resource Sharing (CORS). Since cookies can only be used for the domain from which they originated, they aren’t much help for APIs on different domains than the application. Using JWTs for authentication in this case ensures that the RESTful API is stateless</li>
</ul>
</li>
</ul>
<h4 id="Use-cases"><a href="#Use-cases" class="headerlink" title="Use cases"></a>Use cases</h4><ul>
<li>Authorization: This is the most common scenario for using JWT. Once the user is logged in, each subsequent request will include the JWT, allowing the user to access routes, services, and resources that are permitted with that token. Single Sign On is a feature that widely uses JWT nowadays, because of its small overhead and its ability to be easily used across different domains.</li>
</ul>
<h3 id="ACL-Roles-and-permissions"><a href="#ACL-Roles-and-permissions" class="headerlink" title="ACL / Roles and permissions"></a>ACL / Roles and permissions</h3><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/38893178/what-is-the-best-way-to-implement-roles-and-permission-in-express-rest-api">Permissions should be handled by defining specific user roles with their access control lists</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/OptimalBits/node_acl"><code>node_acl</code></a> package</li>
<li><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/accesscontrol"><code>accesscontrol</code></a> package</li>
</ul>
<h2 id="Sources"><a href="#Sources" class="headerlink" title="Sources"></a>Sources</h2><ul>
<li><a target="_blank" rel="noopener" href="https://auth0.com/learn/json-web-tokens/">https://auth0.com/learn/json-web-tokens/</a></li>
<li><a target="_blank" rel="noopener" href="https://betterprogramming.pub/authentication-and-authorization-using-redis-49c5f0e6b311">https://betterprogramming.pub/authentication-and-authorization-using-redis-49c5f0e6b311</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/07/03/Backend/Authentication-and-Authorization/" data-id="ckqqux39c00020tvf73u8dh7l" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Authentication/" rel="tag">Authentication</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Authorization/" rel="tag">Authorization</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Backend/REST-APIs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/07/03/Backend/REST-APIs/" class="article-date">
  <time datetime="2021-07-03T22:00:00.000Z" itemprop="datePublished">2021-07-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Backend/">Backend</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/07/03/Backend/REST-APIs/">REST APIs</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="REST-APIs"><a href="#REST-APIs" class="headerlink" title="REST APIs"></a>REST APIs</h1><ul>
<li>GET, POST (/book), DELETE, PUT (/book/:id) to perform CRUD</li>
<li>detailed explanation:<ul>
<li>POST (create a resource or generally provide data)</li>
<li>GET (retrieve an index of resources or an individual resource)</li>
<li>PUT (create or replace a resource) - you send whole object to change</li>
<li>PATCH (update/modify a resource) - you send only specific properties to change</li>
<li>DELETE (remove a resource)</li>
</ul>
</li>
<li>sample paths:<ul>
<li>[POST] endpoint/users</li>
<li>[GET] endpoint/users (list users)</li>
<li>[GET] endpoint/users/:userId (get specific user)</li>
<li>[PATCH] endpoint/users/:userId (update the data for the specified user)</li>
<li>[DELETE] endpoint/users/:userId (remove the specified user)</li>
<li>[GET] <code>/users/:userId/books/:bookId</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Route path: &#x2F;flights&#x2F;:from-:to</span><br><span class="line">Request URL: http:&#x2F;&#x2F;localhost:3000&#x2F;flights&#x2F;LAX-SFO</span><br><span class="line">req.params: &#123; &quot;from&quot;: &quot;LAX&quot;, &quot;to&quot;: &quot;SFO&quot; &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/07/03/Backend/REST-APIs/" data-id="ckqqux39k000b0tvf37kxa8ln" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/REST-APIs/" rel="tag">REST APIs</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Backend/HTTP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/07/03/Backend/HTTP/" class="article-date">
  <time datetime="2021-07-03T22:00:00.000Z" itemprop="datePublished">2021-07-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Backend/">Backend</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/07/03/Backend/HTTP/">HTTP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><h2 id="HTTP-2-0-multiplexing-server-push-header-compression"><a href="#HTTP-2-0-multiplexing-server-push-header-compression" class="headerlink" title="HTTP 2.0: multiplexing, server push, header compression"></a>HTTP 2.0: <strong>multiplexing, server push, header compression</strong></h2><ul>
<li>In particular, HTTP/2 is much faster and more efficient than HTTP/1.1</li>
<li>In HTTP/2, developers have hands-on, detailed <strong>control over prioritization</strong>. This allows them to maximize perceived and actual page load speed to a degree that was not possible in HTTP/1.1</li>
<li>HTTP/2 is <strong>multiplexed, i.e., it can initiate multiple requests in parallel over a single TCP connection</strong>. As a result, web pages containing several elements are delivered over one TCP connection. These capabilities solve the head-of-line blocking problem in HTTP/1.1, in which a packet at the front of the line blocks others from being transmitted.</li>
<li>HTTP/2 uses <strong>header compression</strong> to reduce the overhead caused by TCP’s slow-start mechanism.</li>
<li>As opposed to HTTP/1.1, which keeps all requests and responses in plain text format, <strong>HTTP/2 uses the binary framing layer to encapsulate all messages in binary format</strong>, while still maintaining HTTP semantics, such as verbs, methods, and headers.</li>
<li>HTTP/2 <strong>allows a server to “push” content</strong> to a client before the client asks for it. </li>
<li><strong>HTTP/3 runs over QUIC instead of TCP</strong>. QUIC is a faster and more secure transport layer protocol that is designed for the needs of the modern Internet.</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/07/03/Backend/HTTP/" data-id="ckqqux39g00050tvf08udhcyv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/HTTP/" rel="tag">HTTP</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Backend/Security" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/07/03/Backend/Security/" class="article-date">
  <time datetime="2021-07-03T22:00:00.000Z" itemprop="datePublished">2021-07-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Backend/">Backend</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/07/03/Backend/Security/">Security</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h1><ul>
<li><strong>File inclusion vulnerability</strong> - doesn’t upload files like .exe or some scripts than can be accidentally run on server</li>
<li><strong>SQL injection</strong> - clean user input</li>
<li><strong>CSRF (Cross site request forgery)</strong> and cookies<ul>
<li>In a cross-site request forgery attack, the attacker tries to force/trick you into making a request which you did not intend. This could be sending you a link that makes you involuntarily change your password. A malicious link could look like that: <code>https://security.stackexchange.com/account?new_password=abc123</code></li>
<li><strong>The browser automatically sending cookies also has a big downside, which is CSRF attacks</strong>. In a CSRF attack, a malicious website takes advantage of the fact that your <strong>browser will automatically attach authentication cookies to requests</strong> to that domain and tricks your browser into executing a request.</li>
<li>cookies make it more difficult for non-browser based applications (like mobile to tablet apps) to consume your API.</li>
<li>JWTs are stored as cookies on many occasions, and cookies are vulnerable/susceptible to CSRF (Cross-site Request Forgery) attacks. One of the many ways <strong>to prevent CSRF attacks is to ensure that your cookie is accessible by only your domain</strong>. As a developer, ensure that necessary CSRF protections are put in place to avoid these attacks, regardless of the use of JWTs.</li>
</ul>
</li>
<li><strong>XSS</strong><ul>
<li>In a <strong>cross-site scripting attack</strong>, the attacker makes you involuntarily execute client-side code, most likely Javascript. A typical reflected XSS attacking attempt could look like this: <code>https://security.stackexchange.com/search?q=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></li>
<li>(Cross-site scripting): an attacker embeds a script in the victim site (<strong>the victim site is only vulnerable if inputs are not sanitized correctly</strong>), and the attacker’s script can do anything JavaScript is allowed to do on the page.</li>
<li><strong>If you store JWT tokens in local storage, the attacker’s script could read those tokens, and also send those tokens to a server they control</strong>. In fact, a lot of people advocate that very sensitive data shouldn’t be stored in Web Storage because of XSS attacks</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/07/03/Backend/Security/" data-id="ckqqux39m000f0tvfejxz57vs" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Security/" rel="tag">Security</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Backend/ElasticSearch" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/07/02/Backend/ElasticSearch/" class="article-date">
  <time datetime="2021-07-02T22:00:00.000Z" itemprop="datePublished">2021-07-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Backend/">Backend</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/07/02/Backend/ElasticSearch/">ElasticSearch</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ElasticSearch"><a href="#ElasticSearch" class="headerlink" title="ElasticSearch"></a>ElasticSearch</h1><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ul>
<li>theory: <a target="_blank" rel="noopener" href="https://medium.com/better-programming/introduction-to-elasticsearch-using-node-js-part-1-164311327557">https://medium.com/better-programming/introduction-to-elasticsearch-using-node-js-part-1-164311327557</a></li>
<li>In practice in Node.js:<br><a target="_blank" rel="noopener" href="https://medium.com/better-programming/introduction-to-elasticsearch-using-node-js-part-2-4c804427bc94">https://medium.com/better-programming/introduction-to-elasticsearch-using-node-js-part-2-4c804427bc94</a></li>
<li>Elasticsearch course on Udemy to buy and watch:<br><a target="_blank" rel="noopener" href="https://www.udemy.com/course/elasticsearch-complete-guide/">https://www.udemy.com/course/elasticsearch-complete-guide/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/07/02/Backend/ElasticSearch/" data-id="ckqqux39d00030tvfglzbeudo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/ElasticSearch/" rel="tag">ElasticSearch</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Nodejs/Nodejs-Nestjs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/06/30/Nodejs/Nodejs-Nestjs/" class="article-date">
  <time datetime="2021-06-30T22:00:00.000Z" itemprop="datePublished">2021-07-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Node-js/">Node.js</a>►<a class="article-category-link" href="/blog/categories/Node-js/Nest-js/">Nest.js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/06/30/Nodejs/Nodejs-Nestjs/">Node.js - Nest.js framework</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Nest-js-framework"><a href="#Nest-js-framework" class="headerlink" title="Nest.js framework"></a>Nest.js framework</h1><ul>
<li>Currently, it supports two libraries — Express and Fastify</li>
<li>it forces developers to use a specific architecture by introducing <strong>Angular-like modules, services, and controllers</strong>, ensuring the application is scalable, highly testable, and loosely coupled</li>
<li>A controller is a class annotated with the <code>@Controller</code> decorator and it checks what request comes in and calls the appropriate service’s method. They don’t care about what’s going on between the request and the response.</li>
<li>A service is a class annotated with the @Injectable decorator. It contains domain (business) logic. By separating the access layer (controllers) and logic layer (services), we have a clear separation of concerns.</li>
<li><strong>Dependency injection is one of the most important aspects of Nest</strong>. By providing the support out of the box, Nest allows us to write <strong>loosely coupled code</strong>, which, in turn, is also <strong>easily testable</strong>.</li>
<li>By using dependency injection, it is very easy to mock out the modules we are not currently testing thanks to Nest’s <em>custom providers</em> feature.</li>
<li>Nest stays on top of the new trends and makes it very easy to write an application based on the microservices architecture.</li>
<li>Nest is used for building REST APIs but also the architecture can be used to create a GraphQL API as well.</li>
</ul>
<h2 id="Sample-Controller"><a href="#Sample-Controller" class="headerlink" title="Sample Controller"></a>Sample Controller</h2><h3 id="Sample-1"><a href="#Sample-1" class="headerlink" title="Sample 1"></a>Sample 1</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@Controller(<span class="string">&#x27;cats&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CatsController</span> </span>&#123;</span><br><span class="line">  @Post()</span><br><span class="line">  <span class="function"><span class="title">create</span>(<span class="params">@Body() createCatDto: CreateCatDto</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;This action adds a new cat&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Get()</span><br><span class="line">  <span class="function"><span class="title">findAll</span>(<span class="params">@Query() query: ListAllEntities</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`This action returns all cats (limit: <span class="subst">$&#123;query.limit&#125;</span> items)`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Get(<span class="string">&#x27;:id&#x27;</span>)</span><br><span class="line">  <span class="function"><span class="title">findOne</span>(<span class="params">@Param(<span class="string">&#x27;id&#x27;</span>) id: string</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`This action returns a #<span class="subst">$&#123;id&#125;</span> cat`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Put(<span class="string">&#x27;:id&#x27;</span>)</span><br><span class="line">  <span class="function"><span class="title">update</span>(<span class="params">@Param(<span class="string">&#x27;id&#x27;</span>) id: string, @Body() updateCatDto: UpdateCatDto</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`This action updates a #<span class="subst">$&#123;id&#125;</span> cat`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Delete(<span class="string">&#x27;:id&#x27;</span>)</span><br><span class="line">  <span class="function"><span class="title">remove</span>(<span class="params">@Param(<span class="string">&#x27;id&#x27;</span>) id: string</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`This action removes a #<span class="subst">$&#123;id&#125;</span> cat`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Sample-2"><a href="#Sample-2" class="headerlink" title="Sample 2"></a>Sample 2</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Controller(<span class="string">&#x27;cats&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CatsController</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">private readonly catsService: CatsService</span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @Post()</span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">create</span>(<span class="params">@Body() createCatDto: CreateCatDto</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.catsService.create(createCatDto);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Get()</span><br><span class="line">  <span class="keyword">async</span> findAll(): <span class="built_in">Promise</span>&lt;Cat[]&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.catsService.findAll();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Service"><a href="#Sample-Service" class="headerlink" title="Sample Service"></a>Sample Service</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Injectable()</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CatsService</span> </span>&#123;</span><br><span class="line">  private readonly cats: Cat[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">create</span>(<span class="params">cat: Cat</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.cats.push(cat);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  findAll(): Cat[] &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.cats;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Sources"><a href="#Sources" class="headerlink" title="Sources"></a>Sources</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.logrocket.com/node-back-end-next-level-nestjs/">Take your Node backend to the next level with NestJS</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/06/30/Nodejs/Nodejs-Nestjs/" data-id="ckqqux3ag00200tvf19zphd5k" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Node-js/" rel="tag">Node.js</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Nodejs/Nodejs-threads" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/06/29/Nodejs/Nodejs-threads/" class="article-date">
  <time datetime="2021-06-29T22:00:00.000Z" itemprop="datePublished">2021-06-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Node-js/">Node.js</a>►<a class="article-category-link" href="/blog/categories/Node-js/Basics/">Basics</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2021/06/29/Nodejs/Nodejs-threads/">Node.js threads</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Backgrounds"><a href="#Backgrounds" class="headerlink" title="Backgrounds"></a>Backgrounds</h1><ul>
<li>The virtual machine and the operating system run the I/O in parallel for us, and when it’s time to send data back to our JavaScript code, the JavaScript part is the one that runs in a single thread. So everything runs in parallel except for our JavaScript code:<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> flag = <span class="literal">false</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  flag = <span class="literal">true</span></span><br><span class="line">  <span class="comment">// More code (that doesn&#x27;t change `flag`)...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// We can be sure that `flag` here is true.</span></span><br><span class="line">  <span class="comment">// There&#x27;s no way another code block could have changed</span></span><br><span class="line">  <span class="comment">// `flag` since this block is synchronous.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>For example, in Java, even some numeric types are not atomic; if you don’t synchronize their access, you could end up having two threads change the value of a variable. The result would be that after both threads have accessed the variable, it has a few bytes changed by one thread and a few bytes changed by the other thread — and, thus, not resulting in any valid value.</li>
<li>Worker pool is an execution model that spawns and handles separate threads, which then synchronously perform the task and return the result to the event loop. The event loop then executes the provided callback with said result. A worker pool is a given number of previously created workers sitting and listening for the message event. Eight workers created below:<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pool = <span class="keyword">new</span> WorkerPool(path.join(__dirname, <span class="string">&#x27;./test-worker.js&#x27;</span>), <span class="number">8</span>);</span><br></pre></td></tr></table></figure></li>
<li>In short, main event pool takes care of asynchronous I/O operations — primarily, interactions with the system’s disk and network. It is mainly used by modules such as <code>fs</code> (I/O-heavy) or <code>crypto</code> (CPU-heavy). Worker pool is implemented in libuv.<br><a target="_blank" rel="noopener" href="https://blog.logrocket.com/node-js-multithreading-what-are-worker-threads-and-why-do-they-matter-48ab102f8b10/">source 1</a><br><a target="_blank" rel="noopener" href="https://blog.logrocket.com/a-complete-guide-to-threads-in-node-js-4fa3898fe74f/">source 2</a></li>
</ul>
<h1 id="worker-threads-module"><a href="#worker-threads-module" class="headerlink" title="worker_threads module"></a><code>worker_threads</code> module</h1><ul>
<li>A thread worker is a piece of code (usually taken out of a file) spawned in a separate thread.</li>
<li>Here’s an example of a file that contains a worker that is spawned, executed, and then closed:<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; parentPort &#125; <span class="keyword">from</span> <span class="string">&#x27;worker_threads&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> collection = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i += <span class="number">1</span>) &#123;</span><br><span class="line"> collection[i] = i;</span><br><span class="line">&#125;</span><br><span class="line">parentPort.postMessage(collection);</span><br></pre></td></tr></table></figure></li>
<li>Here’s an example of a worker that can wait for a long period of time before it is given a task:<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; parentPort &#125; <span class="keyword">from</span> <span class="string">&#x27;worker_threads&#x27;</span>;</span><br><span class="line">parentPort.on(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">data: any</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="keyword">const</span> result = doSomething(data);</span><br><span class="line"> parentPort.postMessage(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<a target="_blank" rel="noopener" href="https://blog.logrocket.com/a-complete-guide-to-threads-in-node-js-4fa3898fe74f/">source</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mateuszroth.github.io/blog/2021/06/29/Nodejs/Nodejs-threads/" data-id="ckqqux3ak00280tvf4io1dtun" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Node-js/" rel="tag">Node.js</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><a class="page-number" href="/blog/page/3/">3</a><a class="page-number" href="/blog/page/4/">4</a><a class="extend next" rel="next" href="/blog/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  <div style="
    padding-top: 10px;
    text-align: center;
  ">
      <img
        src="https://mateuszroth.pl/img/profile.jpeg"
        width="150" style="border-radius: 50%; padding-bottom: 10px;" />
      <div>
        <a href="https://www.linkedin.com/in/mateuszroth" target="_blank">Linkedin</a> | <a href="https://github.com/mateuszroth" target="_blank">Github</a> | <a href="https://www.facebook.com/mateuszroth" target="_blank">Facebook</a>
      </div>
  </div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Backend/">Backend</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Frontend/">Frontend</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Frontend/CSS/">CSS</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Frontend/Other/">Other</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/JavaScript/">JavaScript</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/JavaScript/Basics/">Basics</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/JavaScript/OOP/">OOP</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/JavaScript/Performance/">Performance</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/JavaScript/Tests/">Tests</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/JavaScript/TypeScript/">TypeScript</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Mobile/">Mobile</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Mobile/Cordova/">Cordova</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Mobile/Swift/">Swift</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Mobile/Swift/iOS/">iOS</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Node-js/">Node.js</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Node-js/Basics/">Basics</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Node-js/GraphQL/">GraphQL</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Node-js/Nest-js/">Nest.js</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Node-js/Scripts/">Scripts</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/React/">React</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/React/Basics/">Basics</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/React/Hooks/">Hooks</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/React/State-management/">State management</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/React/TypeScript/">TypeScript</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Software-Engineering/">Software Engineering</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Software-Engineering/Basics/">Basics</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Software-Engineering/OOP/">OOP</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Software-Engineering/Programming-languages/">Programming languages</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Software-Engineering/Tests/">Tests</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Android/" rel="tag">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Authentication/" rel="tag">Authentication</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Authorization/" rel="tag">Authorization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Backend/" rel="tag">Backend</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/C/" rel="tag">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Cordova/" rel="tag">Cordova</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/ElasticSearch/" rel="tag">ElasticSearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Elm/" rel="tag">Elm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Frontend/" rel="tag">Frontend</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/GraphQL/" rel="tag">GraphQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/HTTP/" rel="tag">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Microservices/" rel="tag">Microservices</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/MobX/" rel="tag">MobX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Mobile/" rel="tag">Mobile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Node-js/" rel="tag">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/OOP/" rel="tag">OOP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Objective-C/" rel="tag">Objective C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Programming-languages/" rel="tag">Programming languages</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/REST-APIs/" rel="tag">REST APIs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/RabbitMQ/" rel="tag">RabbitMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/React-Hooks/" rel="tag">React Hooks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/React-state-management/" rel="tag">React state management</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Reason/" rel="tag">Reason</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Redux/" rel="tag">Redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Security/" rel="tag">Security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Software-Engineering/" rel="tag">Software Engineering</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Swift/" rel="tag">Swift</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Tests/" rel="tag">Tests</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/TypeScript/" rel="tag">TypeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/iOS/" rel="tag">iOS</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/Android/" style="font-size: 10px;">Android</a> <a href="/blog/tags/Authentication/" style="font-size: 10px;">Authentication</a> <a href="/blog/tags/Authorization/" style="font-size: 10px;">Authorization</a> <a href="/blog/tags/Backend/" style="font-size: 20px;">Backend</a> <a href="/blog/tags/C/" style="font-size: 10px;">C#</a> <a href="/blog/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/blog/tags/Cordova/" style="font-size: 10px;">Cordova</a> <a href="/blog/tags/ElasticSearch/" style="font-size: 10px;">ElasticSearch</a> <a href="/blog/tags/Elm/" style="font-size: 10px;">Elm</a> <a href="/blog/tags/Frontend/" style="font-size: 13.33px;">Frontend</a> <a href="/blog/tags/GraphQL/" style="font-size: 10px;">GraphQL</a> <a href="/blog/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/blog/tags/JavaScript/" style="font-size: 18.33px;">JavaScript</a> <a href="/blog/tags/Microservices/" style="font-size: 10px;">Microservices</a> <a href="/blog/tags/MobX/" style="font-size: 10px;">MobX</a> <a href="/blog/tags/Mobile/" style="font-size: 11.67px;">Mobile</a> <a href="/blog/tags/Node-js/" style="font-size: 15px;">Node.js</a> <a href="/blog/tags/OOP/" style="font-size: 11.67px;">OOP</a> <a href="/blog/tags/Objective-C/" style="font-size: 10px;">Objective C</a> <a href="/blog/tags/Programming-languages/" style="font-size: 13.33px;">Programming languages</a> <a href="/blog/tags/REST-APIs/" style="font-size: 10px;">REST APIs</a> <a href="/blog/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/blog/tags/React/" style="font-size: 16.67px;">React</a> <a href="/blog/tags/React-Hooks/" style="font-size: 13.33px;">React Hooks</a> <a href="/blog/tags/React-state-management/" style="font-size: 10px;">React state management</a> <a href="/blog/tags/Reason/" style="font-size: 10px;">Reason</a> <a href="/blog/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/blog/tags/Redux/" style="font-size: 10px;">Redux</a> <a href="/blog/tags/Security/" style="font-size: 10px;">Security</a> <a href="/blog/tags/Software-Engineering/" style="font-size: 16.67px;">Software Engineering</a> <a href="/blog/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/blog/tags/Tests/" style="font-size: 11.67px;">Tests</a> <a href="/blog/tags/TypeScript/" style="font-size: 11.67px;">TypeScript</a> <a href="/blog/tags/iOS/" style="font-size: 10px;">iOS</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/01/">January 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2021/07/04/Backend/Message-brokers/">Message brokers</a>
          </li>
        
          <li>
            <a href="/blog/2021/07/04/Backend/Microservices/">Microservices</a>
          </li>
        
          <li>
            <a href="/blog/2021/07/03/Backend/Redis/">Redis</a>
          </li>
        
          <li>
            <a href="/blog/2021/07/03/Backend/Authentication-and-Authorization/">Authentication and Authorization</a>
          </li>
        
          <li>
            <a href="/blog/2021/07/03/Backend/REST-APIs/">REST APIs</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Mateusz Roth<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/about-me" class="mobile-nav-link">About me</a>
  
    <a href="/blog/categories/JavaScript/" class="mobile-nav-link">JavaScript</a>
  
    <a href="/blog/categories/Node-js/" class="mobile-nav-link">Node.js</a>
  
    <a href="/blog/categories/React/" class="mobile-nav-link">React</a>
  
    <a href="/blog/categories/Backend/" class="mobile-nav-link">Backend</a>
  
    <a href="/blog/categories/Software-Engineering/" class="mobile-nav-link">Software Engineering</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Other archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">

  
<script src="/blog/fancybox/jquery.fancybox.pack.js"></script>




<script src="/blog/js/script.js"></script>




  </div>
</body>
</html>